Ported from Adafruit's CircuitPython driver.

This is code is currently only very lightly-tested ("It compiles? Ship it!")
